<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëÆ Grandpa Gary's 80th Birthday Bash! üöì</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts - Sturdy & Classic -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Oswego/Impact style for headers, Roboto/Open Sans for body -->
    <link
        href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Roboto+Slab:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">

    <!-- Canvas Confetti for fun animations -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- HEIC to JPG Converter -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
</head>

<body class="min-h-screen police-theme">

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <!-- 3D Patrol Cop Overlay (desktop only, respects reduced-motion) -->
    <div id="patrol-cop-overlay"></div>

    <!-- Police Line Tape (Top) -->
    <div class="police-tape-container top-tape">
        <div class="police-tape">POLICE LINE DO NOT CROSS &nbsp;&nbsp;&nbsp; POLICE LINE DO NOT CROSS &nbsp;&nbsp;&nbsp;
            POLICE LINE DO NOT CROSS</div>
    </div>

    <!-- Background Badge Watermark -->
    <div class="badge-watermark"></div>

    <!-- Traffic Lights / Siren Glow -->
    <div class="siren-glow"></div>

    <!-- Police Car Chase - 3D Three.js car with flashing lights (respects reduced-motion) -->
    <div id="police-car-chase" class="police-car-chase-container" aria-hidden="true"></div>

    <!-- Main Container -->
    <div class="container mx-auto px-4 pt-4 pb-12 max-w-6xl relative z-10">

        <!-- Header Section -->
        <header class="text-center mb-12 animate-fadeIn relative header-compact">
            <div class="header-badge-overlap">
                <div class="badge-container">
                    <img src="/police-badge.svg" alt="Police Badge - 80" class="police-badge-icon">
                </div>
                <h1 id="birthdayTitle" class="birthday-title-overlap text-6xl md:text-8xl font-bold animate-bounce-slow header-text uppercase"
                    style="cursor: pointer; user-select: none;">
                    <span class="text-gold">Grandpa Gary's</span>
                    <br>
                    <span class="text-white">80th Birthday Bash!</span>
                </h1>
            </div>

            <div class="police-tape-divider my-4"></div>

            <p class="text-xl md:text-3xl mb-6 subheader-text font-serif text-gray-300">
                Come celebrate with our favorite retired officer!
            </p>

            <!-- Add Message Button -->
            <button id="openModalBtn"
                class="police-btn-large transform hover:scale-105 transition-all duration-300 animate-pulse-soft">
                üöî Leave a Message üöî
            </button>
        </header>

        <!-- Case Files Drop Zone (formerly Polaroid Zone) -->
        <section id="polaroidZone" class="polaroid-zone">
            <!-- Messages will drop here as "Case Files" -->
            <div id="loadingIndicator" class="polaroid-loading">
                <div class="polaroid-loading__spinner"></div>
                <p class="polaroid-loading__text">LOADING EVIDENCE...</p>
            </div>
        </section>
    </div>

    <!-- Police Line Tape (Bottom) -->
    <div class="police-tape-container bottom-tape">
        <div class="police-tape-reverse">CRIME SCENE DO NOT CROSS &nbsp;&nbsp;&nbsp; CRIME SCENE DO NOT CROSS
            &nbsp;&nbsp;&nbsp; CRIME SCENE DO NOT CROSS</div>
    </div>

    <!-- Modal for Adding Message -->
    <div id="messageModal" class="fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center z-50 p-4">
        <div
            class="bg-gray-900 border-4 border-gold rounded-xl shadow-2xl max-w-lg w-full p-8 transform transition-all animate-scaleIn relative overflow-hidden">
            <!-- Modal Header -->
            <div class="flex justify-between items-center mb-6 border-b border-gray-700 pb-4">
                <h2 class="text-3xl font-bold text-white font-oswald uppercase track-wider">üìù File A Report</h2>
                <button id="closeModalBtn"
                    class="text-gray-400 hover:text-white text-4xl leading-none focus:outline-none">
                    &times;
                </button>
            </div>

            <!-- Message Form -->
            <form id="messageForm" class="space-y-6 relative z-10">
                <!-- Name Input -->
                <div>
                    <label for="nameInput" class="block text-sm font-bold text-gold mb-2 uppercase tracking-wide">
                        Reporting Officer (Your Name)
                    </label>
                    <input type="text" id="nameInput" required placeholder="Officer Name..."
                        class="w-full px-4 py-3 bg-gray-800 border-2 border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-gold focus:ring-1 focus:ring-gold outline-none transition-all">
                </div>

                <!-- Message Input -->
                <div>
                    <label for="messageInput" class="block text-sm font-bold text-gold mb-2 uppercase tracking-wide">
                        Statement / Birthday Wish
                    </label>
                    <textarea id="messageInput" required rows="4" placeholder="Enter your statement for the record..."
                        class="w-full px-4 py-3 bg-gray-800 border-2 border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-gold focus:ring-1 focus:ring-gold outline-none transition-all resize-none"></textarea>
                </div>

                <!-- File Upload -->
                <div>
                    <label for="fileInput" class="block text-sm font-bold text-gold mb-2 uppercase tracking-wide">
                        Attach Evidence (Photo/Video)
                    </label>
                    <input type="file" id="fileInput" accept="image/*,video/*"
                        class="w-full px-4 py-3 bg-gray-800 border-2 border-dashed border-gray-600 rounded-lg text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-bold file:bg-blue-900 file:text-gold hover:file:bg-blue-800 transition-all cursor-pointer">
                    <p class="text-xs text-gray-500 mt-2">Max 25MB ‚Ä¢ Evidence must be clear</p>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitBtn"
                    class="w-full bg-blue-900 hover:bg-blue-800 border-2 border-gold text-white font-bold py-4 px-6 rounded-lg shadow-lg transform hover:scale-102 transition-all duration-300 uppercase tracking-widest">
                    Submit Report
                </button>

                <!-- Upload Progress -->
                <div id="uploadProgress" class="hidden">
                    <div class="w-full bg-gray-700 rounded-full h-2.5 mt-4">
                        <div id="progressBar" class="bg-gold h-2.5 rounded-full transition-all duration-300"
                            style="width: 0%"></div>
                    </div>
                    <p id="progressText" class="text-sm text-gold mt-2 text-center font-mono">UPLOADING EVIDENCE...</p>
                </div>
            </form>
        </div>
    </div>

    <!-- Media Preview Modal -->
    <div id="mediaPreviewModal" class="media-preview-modal hidden">
        <div class="media-preview-overlay"></div>
        <button id="closePreviewBtn" class="media-preview-close">&times;</button>
        <button id="downloadMediaBtn" class="media-preview-download" title="Download Evidence">‚¨á</button>
        <button id="prevMediaBtn" class="media-preview-nav media-preview-prev">‚Äπ</button>
        <button id="nextMediaBtn" class="media-preview-nav media-preview-next">‚Ä∫</button>
        <div class="media-preview-content">
            <div id="mediaPreviewContainer" class="media-preview-container">
                <!-- Media will be inserted here -->
            </div>
            <div id="mediaPreviewCaption" class="media-preview-caption">
                <div class="media-preview-author"></div>
                <div class="media-preview-message"></div>
            </div>
        </div>
    </div>

    <!-- Patrol Cop Overlay (3D avatar) -->
    <script type="module" src="/patrol-cop-overlay.js"></script>
    <!-- Police Car Chase (3D car) -->
    <script type="module" src="/police-car-chase.js"></script>
    <!-- Main Application Script (includes Firebase) -->
    <script type="module" src="/script.js"></script>

</body>

</html>